<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0">
    <title>Nano Faucet</title>
    <script src="https://www.google.com/recaptcha/api.js?render=6Le3sm4pAAAAAJIkQWdAX4cuPjDrfdk_1-lErb8X"></script>
    <link rel="stylesheet" href="styles.css">
    <script>
        function createForm() {
            console.log('Creating form...');  // Debug message
            const formContainer = document.getElementById('dynamicForm');

            // Create form element
            const form = document.createElement('form');
            form.id = 'nanoForm';
            form.method = 'post';

            // Create input element for Nano address
            const nanoAddressLabel = document.createElement('label');
            nanoAddressLabel.textContent = 'Nano Address:';
            const nanoAddressInput = document.createElement('input');
            nanoAddressInput.type = 'text';
            nanoAddressInput.id = 'destination';
            nanoAddressInput.name = 'destination';
            nanoAddressInput.required = true;

            // Append input and label to the form
            form.appendChild(nanoAddressLabel);
            form.appendChild(nanoAddressInput);

            // Append the form to the container
            formContainer.appendChild(form);
        }
	function submitForm() {
		var responseContainer = document.getElementById('responseContainer');
                responseContainer.innerHTML = "Processing...";  // Display the plain text response
    		const destination = document.getElementById('destination').value;

    grecaptcha.ready(function () {
        // Request a reCAPTCHA token
        grecaptcha.execute('6Le3sm4pAAAAAJIkQWdAX4cuPjDrfdk_1-lErb8X', { action: 'submit_form' }).then(
            function (token) {
                // Create a JSON object with form data
                const formData = {
                    destination: destination,
                    'g-recaptcha-response': token
                };

                // Send the JSON data to the server using fetch
                fetch('/send', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData),
                })
                .then(response => response.text())  // Use response.text() to get the plain text response
                .then(data => {
                    // Update the content dynamically with the response
                    //responseContainer = document.getElementById('responseContainer');
                    responseContainer.innerHTML = data;  // Display the plain text response
                })
                .catch(error => {
                    console.error('Error:', error);
                    // Handle error if necessary
                });
            },
            function (error) {
                // Handle reCAPTCHA execution error
                console.error('reCAPTCHA execution error:', error);
                // You may want to inform the user or take alternative actions
            }
        );
    });
}


        
        // Create the form dynamically when the page loads
        window.onload = function () {
            console.log('Page loaded.');  // Debug message
            createForm();
        };
    </script>
</head>
<body>

    <div id="header">
        <img src="https://faucet.nanoriver.io/logo.png" alt="Nano Raffle Logo">
    </div>
<a href="https://benture.io" target="_blank" style="text-decoration: none; background-color: #78A7EA; color: white; padding: 10px 20px; border-radius: 5px; display: inline-block;">Remote Jobs | Benture </a>
<br>

    <div id="form-container">
        <h1>Get Free Nano!</h1>
        <div id="dynamicForm"></div>
        <button type="button" onclick="submitForm()">Get Nano</button>
    </div>

    <div id="responseContainer"></div>

      <a href="https://rpc.nano.to/" target="_blank" style="text-decoration: none; background-color: #4CAF50; color: white; padding: 10px 20px; border-radius: 5px; display: inline-block;"> Sponsored by RPC.Nano.To</a>
      <br>
	<br>

</body>
<footer style="color: white;">Made with <span style="color: red;">‚ù§</span> by <a href="https://github.com/blockracer" style="color: white;">@blockracer</a></footer>
</html>

